# 国家标准状态查询 - Web应用

基于 Streamlit 构建的Web版本，支持上传Excel文件、实时进度显示和结果下载。

## 功能特性

- 📁 **文件上传**: 支持 .xlsx 和 .xls 格式的Excel文件
- 👁️ **数据预览**: 上传后可预览数据内容
- ⏱️ **实时进度**: 显示查询进度、预估剩余时间
- 📊 **统计信息**: 查询完成后显示状态分布统计
- 💾 **结果下载**: 一键下载查询结果Excel文件
- 🔄 **断点续传**: 自动保存进度，刷新页面不会丢失
- ⚙️ **参数可调**: 支持调整查询间隔、重试次数、代理设置

## 安装依赖

```bash
pip install -r requirements.txt
```

## 启动应用

### macOS/Linux
```bash
./start_web.sh
```

### Windows
```bash
start_web.bat
```

或直接运行：
```bash
streamlit run web_app.py
```

应用将在 http://localhost:8501 启动

## 使用步骤

1. **准备Excel文件**: 确保文件包含名为"标准号"的列
2. **上传文件**: 点击"Browse files"选择Excel文件
3. **设置参数**: 在左侧边栏调整查询间隔（建议3-5秒）
4. **开始查询**: 点击"开始查询"按钮
5. **等待完成**: 查看实时进度和日志
6. **下载结果**: 查询完成后点击下载按钮

## Excel文件格式

| 标准号 | 其他列... |
|--------|-----------|
| GB 2757-2012 | ... |
| GB/T 8170-2008 | ... |

程序会自动添加以下列：
- `ndls状态`: 查询到的状态
- `ndls查询时间`: 查询时间戳
- `替代标准号`: 替代标准的编号
- `替代标准名`: 替代标准的名称

## 注意事项

- 查询过程可能需要几分钟，请耐心等待
- 建议将查询间隔设置为3-5秒以避免触发限流
- 如遇网络问题，可设置代理地址
- 程序会自动保存进度，可放心刷新页面
